# SQL_Project_Data_Academy

## O projektu

Projekt zkoumá proměnu životní úrovně občanů České republiky v průběhu let, a to zejména pohledem na vývoj průměrné mzdy a průměrných cen potravin. Zadání projektu obsahuje pět výzkumných otázek, které budou zodpovězeny na základě dostupných dat. Projekt je jedním z výstupů kurzu Datová akademie s Pythonem, od Engeta.

## Zdroje dat
Zdrojem dat pro zodpovězení výzkumných otázek jsou dvě tabulky: t_david_prihoda_project_sql_primary_final a t_david_prihoda_project_sql_secondary_final.

Tabulka t_david_prihoda_project_sql_primary_final je založena na sloučení tabulek czechia_payroll, která sleduje vývoj průměrných mezd v jednotlivých průmyslových odvětvích od roku 2000 do roku 2021, a czechia_price, která sleduje vývoj pohyb cen základních potravin během let 2006 až 2018, a to na celostátní i krajské úrovni. K tabulce czechia_payroll přidáme tabulku czechia_payroll_industry_branch, abychom měli v datasetu jména průmyslových odvětví, a ze sloupce value_type_code vybereme pouze hodnotu 5958, což je důležité, abychom v datasetu měli pouze průměrné hrubé mzdy na zaměstnance. K tabulce czechia_price doplníme tabulku czecia_price_category, kde jsou jména jednotlivých produktů a jména jejich měrných jednotek (l, kg atd.). Výzkumné otázky se nás ptají na vývoj průměrných cen potravin a mezd na celorepublikové úrovni, proto v tabulce czechia_price ve sloupci region_code vyberu pouze ty hodnoty, které jsou nulové, tím zajistím, že v datasetu budou pouze hodnoty cen potravin na celorepublikové úrovni.

Nejdůležitější otázkou je způsob sloučení tabulek czechia_payrol doplněné o výše uvedené tabulky a czechia-price s doplněnými tabulkami. Tabulky sloučím na základě roků, z tabulky czechia_payroll vyberu sloupec payroll_year a z tabulky czechia_price zvolím sloupec date_from, kde z formátu YYYY_MM_DD k propojení převedu formát pouze na rok. Při volbě způsobu sloučení tabulek je důležité uvědomit si, že sledované roky v tabulkách czechia_payroll a czechia_price jsou odlišné. Můžeme tabulky spojit pomocí operace (INNER) JOIN, která vezme z obou tabulek pouze ty záznamy, kde jsou v obou tabulkách k dispozici stejné roky, nebo pomocí operace LEFT nebo RIGHT JOIN, kdy budou sice v datasetu všechny roky z tabulky czechia_payroll (2000-2021), ale kromě let 2006-2018 k nim nebudu mít hodnoty k cenám potravin. Protože výzkumné otázky jsou založené na porovnávání cen potravin a průměrných mezd, rozhodnul jsem se pro sloučení tabulek pomocí (INNER) JOIN. Nevýhodou tohoto přístupu je, že ztratím informace o průměrných mzdách v letech 2019-2021, tesy v období epidemie COVID. Nicméně vzhledem k zadání výzkumných otázek je toto řešení akceptovatelné.

Tabulka t_david_prihoda_project_sql_secondary_final je založena na sloučení tabulek economies, kde jsou především ekonomické údaje a countries s různými údaji o jednotlivých zemích, kdy spojení bylo provedeno pomocí (INNER) JOIN sloupců country v obou tabulkách, byly vybrány pouze evropské země. Nakonec musím konstatovat, že slučování tabulek nebylo nutné, stačilo využít pouze tabulku economies. Tabulky jsem sloučil, protože jsem se domníval, že budou potřebné doplňující informace k jednotlivým zemím, což se během řešení zadaného úkolu nepotvrdilo.

Výzkumné otázky se ptají na proměny cen potravin a průměrných mezd v jednotlivých letech, v tabulce t_david_prihoda_project_sql_primary_final jsou ale ceny potravin sledovány v jednotlivých letech v týdenních cyklech, zatímco průměrné mzdy jsou sledovány čtvrtletně. Řešením je spočítat u průměrných mezd a cen potravin průměrné hodnoty agregované za jednotlivé roky, tento postup je využit při řešení všech otázek. Při sledování meziročních změn průměrných mezd a cen potravin byla použita window funkce LAG, která vrací hodnotu pro předchozí roky, pro získání údajů o meziročních změnách byl vypočítán podíl sledovaného roku vůči roku minulému, hodnoty větší než 1 znamenají meziroční růst, hodnoty menší než 1 pak indikují pokles.

U otázky č. 5 bylo nutné k získání údajů o HDP České republiky sloučit primární a sekundární tabulku, a to na základě roků, a data ze sekundární tabulky omezit pouze na ta s hodnotou Czech Republic ve sloupci country. K zjištění vztahů mezi HDP, průměrnými mzdami a cenami potravin byla využita funkce CORR, která počítá korelační koeficienty mezi jednotlivými atributy.

## Odpovědi na jednotlivé výzkumné otázky

### 1.	Rostou v průběhu let mzdy ve všech odvětvích, nebo v některých klesají?

Bylo zjištěno, že ve sledovaném období v letech 2006–2018 došlo ve 23 případech k meziročnímu poklesu průměrné mzdy v průmyslovém odvětví. Vývoj mezd v jednotlivých odvětvích je odlišný. Nejčastěji došlo k meziročnímu poklesu průměrné mzdy v odvětví B (Těžba a dobývání), a to čtyřikrát (v letech 2009, 2013, 2014 a 2016). U pěti odvětvích došlo k poklesu průměrné mzdy dvakrát za sledované období, D (Výroba a rozvod elektřiny, plynu, tepla a klimatizovaného Vzduchu) (2013, 2015), I (Ubytování, stravování a pohostinství) (2009, 2011), M (Profesní, vědecké a technické činnosti) (2010, 2013), O (Veřejná správa a obrana; povinné sociální zabezpečení) (2010, 2011), R (Kulturní, zábavní a rekreační činnosti) (2011, 2013). V devíti odvětvích došlo k poklesu průměrné mzdy ve sledovaném období jen jednou. Jde o tyto případy: A (Zemědělství, lesnictví, rybářství) (2009), E (Zásobování vodou; činnosti související s odpady a sanacemi) (2013), F (Stavebnictví) (2013), G (Velkoobchod a maloobchod; opravy a údržba motorových vozidel) (2013), J (Informační a komunikační činnosti (2013), K (Peněžnictví a pojišťovnictví) (2013), L (Činnosti v oblasti nemovitostí) (2013), N (Administrativní a podpůrné činnosti) (2013), P (Vzdělávání) (2010). V kategoriích C (Zpracovatelský průmysl), H (Doprava a skladování), Q (Zdravotní a sociální péče) a S (Ostatní činnosti) k meziročnímu poklesu průměrné mzdy nedošlo. Poklesy v odvětví B Těžba a dobývání může mít souvislost s utlumením těžby ve sledovaném období. Pokud budeme hledat rok, kdy nejčastěji docházelo k meziročnímu poklesu průměrné mzdy, je jím dok 2013, kdy došlo k poklesu v 11 odvětvích. V letech 2009–2011 došlo k meziročnímu poklesu vždy ve 3 odvětvích, nešlo ale o stejné oblasti.

### 2.	Kolik je možné si koupit litrů mléka a kilogramů chleba za první a poslední srovnatelné období v dostupných datech cen a mezd?

Občan České republiky si mohl za svou průměrnou mzdu v roce 2006 koupit 1 287,18 Kg chleba v roce 2018 to bylo 1 342,33 kg chleba. Za průměrnou mzdu bylo možné si v roce 2006 koupit 1 437,44 l mléka, v roce 2018 to bylo 1 641,64 l mléka.

Pokud chceme získat hlubší popis koupěschopnosti obyvatel, můžeme data agregovat podle jednotlivých průmyslových odvětvích. V roce 2018 si nejvíce chleba, 2 314,57 Kg chleba mohli koupit zaměstnanci z odvětví J (Informační a komunikační činnosti), nejméně pak zaměstnanci v odvětví I (Ubytování, stravování a pohostinství), 774,39 Kg chleba. V roce 2006 si nejvíce chleba, 2 461 Kg, mohli koupit lidé pracující v odvětví K (Peněžnictví a pojišťovnictví) (v roce 2018 druhé v pořadí), nejméně, stejně jako v roce 2018, pak lidé zaměstnaní v odvětví I, 706,43 Kg.

V roce 2018 si nejvíce mléka, 2 830,66 l mléka mohli koupit zaměstnanci z odvětví J, na druhém místě byli lidé pracující v odvětví K, nejméně pak zaměstnanci v odvětví I, 947,06 l mléka. V roce 2006 si nejvíce mléka, 2 749 l, mohli koupit lidé pracující v odvětví K, na druhém místě byli zaměstnanci v odvětví J, nejméně, stejně jako v roce 2018, pak lidé zaměstnaní v odvětví I, 788,89 l mléka.

Data ukazují v jednotlivých letech značný rozptyl mezi koupěschopností základních produktů napříč jednotlivými průmyslovými odvětvími. Nejlépe na tom byli lidé pracující v odvětvích J a K, nejméně mléka a chleba si mohli koupit lidé pracující v odvětví I.

### 3.	Která kategorie potravin zdražuje nejpomaleji (je u ní nejnižší percentuální meziroční nársůt)?

Pokud hledáme potraviny, u nichž ceny za sledované období rostli nejpomaleji, tak je třeba uvést, že u dvou kategorií byl průměrný meziroční přírůstek negativní, tudíž v průměru meziročně zlevňovali. Jde o krystalový cukr, u něhož v průměru cena meziročně klesala o 1,92 %, a rajčata, kde v průměru cena za kilo meziročně klesala o 0,74 %. Kategorií s nejmenším meziročním nárůstem jsou banány, jejichž cena meziročně v průměru rostla o 0,81 %.

### 4.	Existuje rok, ve kterém byl meziroční nárůst cen potravin výrazně vyšší než růst mezd (větší než 10 %)?

V datech za sledované období není vidět žádný rok, kdy by meziroční růst cen potravin byl výrazně vyšší, tj. přes 10 %, než meziroční růst průměrné mzdy. Pokud budeme sledovat opačný trend, tj. zda mzdy meziročně rostou více oproti cenám potravin, také o 10 %, zjistíme, že se tak stalo v roce 2009. V tomto roce meziročně klesla průměrná cena potravin o 6,82 %, zatímco průměrné mzdy vzrostly meziročně o 3,16 %. Meziroční růst průměrné mzdy byl v roce 2009 oproti cenám potravin rychlejší o 10,7 %. Důvodem je ale fakt, že zatímco průměrné mzdy rostly, průměrná cena potravin meziročně klesla.

### 5.	Má výška HDP vliv na změny ve mzdách a cenách potravin? Neboli, pokud HDP vzroste výrazněji v jednom roce, projeví se to na cenách potravin či mzdách ve stejném nebo následujícím roce výraznějším růstem?

Pokud budeme sledovat, zda meziroční růst HDP ovlivňuje také meziroční růst cen potravin a průměrné mzdy, tak můžeme konstatovat, že mezi těmito veličinami je středně silný pozitivní vztah. Ve vztahu mezi přírůstkem cen potravin a přírůstkem HDP vychází korelace 0,4756. Ve vztahu mezi přírůstkem průměrných mezd a přírůstkem HDP vychází korelace 0,429. Na základě těchto dat můžeme říct, že růst HDP částečně působí na růst cen potravin a na růst průměrných mezd. Růst ale není u jednotlivých veličin stejně silný, tj. pokud meziročně výrazně vzroste HDP, neznamená to, že stejně výrazně vroste cena potravin nebo průměrná mzda. Pokud se podíváme na vztah mezi růstem průměrných mezd a růstem cen potravin, vychází korelace 0,2619, což už je slabý vztah, tedy vztah mezi meziročním růstem cen potravin a průměrnými mzdami je slabý.

Když budeme sledovat místo meziročních přírůstků vztah mezi hodnotami HDP, cen potravin a průměrných mezd v jednotlivých letech, uvidíme zde silný vztah. Korelace mezi HDP a průměrnou cenou potravin je 0,8875, mezi HDP a průměrnou mzdou 0,9204 a mezi průměrnou cenou potravin a průměrnou mzdou 0,9211. Vazby mezi veličinami jsou velmi silné.

Tyto hodnoty ukazují dlouhodobý trend, to znamená, že když v jednom roce roste HDP, roste i cena potravin a průměrné mzdy, ale neříká nic o tempu růstu a zda je růst u všech sledovaných veličin stejný. Dynamiku růstu jsme řešili v předchozím kroku a zjistili jsme, že vztahy mezi meziročními přírůstky jsou středně silné, tedy že růst HDP nutně neznamená stejnou dynamiku růstu cen potravin a průměrných mezd.

Odpověď na otázku tedy zní, výška HDP má vliv na ceny potravin a výši průměrné mzdy. Ale není zcela průkazné, že výrazný růst HDP se projeví stejně výrazně na růstu cen potravin a na růstu mezd.
